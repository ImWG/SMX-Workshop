SMX Workshop Beta 1.8 帮助文档

关于
====================================================
该工具可用于读取、制作、修改《帝国时代》《帝国时代2》各版本的图形资源文件，包括《帝国时代》《帝国时代2》使用的SLP、《帝国时代：决定版》的SLP以及《帝国时代2：决定版》的SMP、SMX文件。通过程序，可以实现不同格式之间的转换，从图片文件导入或者将图形导出为图片，以及使用多种内部修改功能。

打开/保存文件
====================================================
除了通过菜单或者按快捷键Ctrl+O，您也可以通过将文件拖入程序窗口的方式来进行打开的操作。
目前支持读取的文件类型包括：SLP 2.0N版（《帝国时代》《帝国时代2》使用）、SLP 4.0X版（《帝国时代：决定版》使用）、SMP以及SMX（均为《帝国时代2：决定版》使用）。不过，现在尚不支持将文件保存为SLP 4.0X或者SMP格式。
不同格式有着不同的编码方式，各自特点如下：
SLP 2.0N——只含有256级普通色、16级玩家色，1级阴影和轮廓，而且阴影、轮廓不可和主体色重叠。
SLP 4.0X——只含有256级普通色、256级玩家色，256级阴影，阴影可以和主体色重叠。
SMP——含有1024级普通色、1024级玩家色，256级阴影和轮廓，主体、阴影、轮廓可以相互重叠。主体像素可选择附带1024级损伤图像。
SMX——同SMP，但文件更小。
图像的数据包括主体、阴影、轮廓和损伤，它们的作用如下：
主体——图像本身，可以包含普通色和玩家色，后者颜色会随着所属玩家的不同而改变。在旧版中，主体只有一种调色板，玩家色也是包括于其中的；而在决定版中，不同图形的主体调色板可以不同，而玩家色使用另外单独的调色板。
阴影——图像的半透明黑色部分，不同的等级代表着颜色深度，在游戏中表现为加深其下的背景像素值。在决定版中，阴影也会用于主体边缘的柔化。当加载SLP 2.0N的单级阴影时，会将其视为第128级。
轮廓——在游戏中作为单位被建筑物或树木遮挡时，显示的具有玩家色的示意形状。轮廓只有一级数据。
损伤——单位受损时在主体图像上使用的不同等级的加深图像，生命值越低则加深程度越重。该数据实际上是和主体合并的。
打开的文件的编辑模式也有SLP与SMX两种，其特性与文件相似，相当于合并数据和分离数据。

导入/导出为图像
====================================================
和打开图形文件一样，将图片文件拖入窗口也可以导入。
支持导入的图片格式包括：BMP、PNG、JPEG、GIF，其中GIF只能读取第一帧。但通常来说，制作单位、建筑物的应选用PNG格式，因BMP不支持透明通道且文件很大，JPEG格式压缩造成像素变动，而GIF支持的颜色又太少。导出时，可选同样的文件格式。
由于帧的数据比较多，单一一张图片无法包含所有内容，因此我们提供了分离数据的功能。在导出时，可以看到一个图像模式的下拉框，包括合并阴影、分离阴影等模式。
导出图像时，如果选择了这些数据，那么图像的宽度就会变为原来的数倍，然后数据会从左向右分布，依次为主体、阴影、轮廓和损伤的图像。如果选择了合并阴影，那么阴影将会和主体合并，若存在重叠像素则阴影位于下方。
没有背景色时，以像素透明度决定阴影、损伤的深度，轮廓数据也会根据透明度来确定。有背景色时，则以像素的亮度决定这些数据，因此它们的背景总是黑色的。导入时主体图像的背景色为左上角像素的颜色，右边的数字框为“容差”，即与找到的背景色的差异在一定范围内的像素都会被认为是透明，一般设为0。
以普通模式导入时，Alpha通道小于255的像素会根据其亮度决定结果——简而言之，亮度低于128的半透明像素可能会被转换为阴影，且亮度越低，则使其成为阴影的Alpha通道上限越高，这样可以在一定程度上避免黑边的现象。玩家色可以选择可用版本之一，且匹配玩家色时，若像素与玩家色和背景色中最相似的颜色的差值在一定范围内（亦由右侧框输入），则优先选择玩家色。
当选择“以透明度区分数据”选项时，图片不仅会将阴影和前面的数据合并，还会根据所属的类型设置其透明度。对于玩家色，Alpha通道的值为255；普通色，值为192-254；更低的则是阴影。未选择此模式，则主体与玩家色均为255。
此外，您可以在导出时选择将多个帧合并为一张图片；或者导入时选择分割，便能从一张图得到多帧。这样做可以节约文件数量，也方便修改。当指定行数和列数后，导入导出的图像会成为含有多帧数据的“带状图”（strip），格子的大小以片段中尺寸最大者为准。例如一个含有160帧的图像导出时选择8行8列，那么会生成3张图片，其中第三张只有32帧，余下的一半都是空白。
关于对齐模式：如果选择“紧密，不对齐”，那么所有的帧将会忽略锚点（但内部数据即主体、阴影等之间的相对位置保持不变），在图片中均位于格子的左上角；选择“对齐”，则帧在格内会保持原来的相对位置；选择“对齐且居中”，则在对齐的基础上更进一步，所有帧的锚点位于格子的中心，这也是导入时缺省的锚点坐标。这三种模式导出的图像尺寸是逐个增加的，但保留的锚点数据也是逐个增加的。不过，您可以选择导出CSV文件，以存储这些锚点数据，导入图片时亦可将其导入。锚点数据的文件名为图片文件名后加.CSV，即含有双重扩展名。

调色板
====================================================
虽然我们没有在游戏中进行过测试，不过两部决定版似乎都可以在同一文件的不同帧中使用不同的调色板。
当帧显示的图像颜色不正确时，在菜单中点击设置调色板，此时像素数据不变，但调色板会发生变化。当需要改变正确显示的帧的调色板时，使用转换调色板功能，以将原有的像素数据通过对应最相似颜色的方式，映射到新调色板上。
与普通色的调色板不同，一个图形文件只能选择一种玩家色版本，且仅仅用于编辑，不能在文件中保存。所以，设置或转换玩家色会令所有的帧同时被改变。玩家色类型包括帝国1（10级）、帝国2（8级）、帝国1决定版和帝国2决定版（均为256级）。
您可以增加自定义的调色板，方法是将文件放在Palettes/Custom/文件夹下。支持的调色板包括游戏中的PAL、PALX格式（以文本形式描述颜色），以及Photoshop的ACT格式（以三个字节表示一种颜色）。这些调色板的编号会从512开始计算，但仅用于编辑，保存时请选择前面的调色板编号。

变换
====================================================
选取帧后，可以对这一组帧进行复制、删除、倒序或者在序列中移动的操作。若选择的帧不是连续的，进行移动后会并在一起，可利用于某些情形。
“旋转/翻转"能够将帧的所有数据以锚点为中心，按一定角度旋转或者左右/上下调过来。”缩放“可以改变帧的尺寸，如果选择了插值，则会进行线性插值运算来替代邻近得到的马赛克，图像质量会更好，但花费的时间也相应会增加。“裁切”功能会将所选帧的所有数据剪去上下左右多出的透明部分，用以缩小游戏中的选择范围，并减小图形文件体积。
设置锚点有两种操作方法：通过对话框或者直接用鼠标。前者可以只调整主体图像、数据、轮廓中的一者，方便修正错位。当同时设置所有图像数据的锚点时，会以主体的锚点为基准，其他数据相对位置不变。通过鼠标设置时，在当前帧图像里用左键点击会直接设置锚点为目标点，而用右键则可以拖动。
工具菜单下的“转换阴影”可以将具有不同深度的阴影转换为第128级阴影或黑色（实际是调色板中最深的颜色）或者两者并用，并通过交错的像素图案表现不同的深度。范围表示渐变的区间，意味着深度低于下限的像素会变成透明，高于上限则均视为最深。等级代表了图案的层次数量，越高则过渡越平滑，同时图案也更粗糙。最后一个“特殊4”级别，是在4级的基础上进行调整，让1/4和3/4深度的图案更均匀，但与其它深度的边界较为突兀。当选择“阴影和黑色”模式时，较浅使用阴影，较深为黑色，实际上等级为所选的2倍。
为帧添加轮廓时，会删除原有的轮廓数据。默认只通过主体图像来生成轮廓，且只有最外一圈，不包括内部不连续的透明部分。

界面
====================================================
窗口的左侧是当前帧图像，可以从菜单中选择显示主体、阴影、轮廓、损伤以及它们的边界。在画面中，按鼠标左键可以播放或停止动画（与查看菜单中的功能相同）；按住鼠标右键拖动，可以移动图像的视点以便于查看。使用滚轮，则可以放大或缩小图像，比菜单中的级别更多。
窗口右侧的列表显示了图形文件的所有帧的缩略图。通过滚轮或滚动条，可以滚动帧序列。点击缩略图，则选择其为当前帧。若按住鼠标左键不动并按下Ctrl，可依次选择多个帧；按住Shift键点击，则可以选择一系列连续的帧。选择多个帧后，可以同时对其进行操作，但左侧只会显示第一个已选帧的内容。
和乌龟包Turtle Pack一样，按Ctrl+方向键可以移动所选帧的数据的锚点。此外，Page Up和Page Down键可用来向前、后切换当前所选帧，按住Ctrl键不放又可以直接跳到第一、最后一帧。